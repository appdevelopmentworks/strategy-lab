# StrategyLab 要件定義書

## 1. プロジェクト概要

| 項目 | 内容 |
|------|------|
| **プロジェクト名** | StrategyLab |
| **リポジトリ名** | strategy-lab |
| **目的** | 複数のトレード戦略を効率的にバックテスト・比較・最適化し、最適な戦略とパラメーターを発見するための支援ツール |
| **ターゲットユーザー** | システムトレーダー、アルゴリズム取引に興味のある投資家 |
| **デプロイ先** | Vercel |

---

## 2. 機能要件

### 2.1 バックテスト機能（MVP優先度：1）

| 機能 | 詳細 |
|------|------|
| **ティッカー入力** | 単一または複数（最大5銘柄）のティッカーコード入力 |
| **戦略実行** | 全戦略を一括バックテスト実行 |
| **算出指標** | 勝率(%)、トレード回数、平均利益(%)、平均損失(%)、総リターン(%)、プロフィットファクター、最大ドローダウン(%)、シャープレシオ、最大連続勝ち数、最大連続負け数、平均保有期間（日） |

### 2.2 結果可視化機能（MVP優先度：2）

| 機能 | 詳細 |
|------|------|
| **一覧表示** | 全戦略の結果をテーブル形式で表示 |
| **ソート機能** | 勝率(%)、総リターン(%)でソート切り替え |
| **棒グラフ表示** | ソート基準に応じた水平/垂直棒グラフ |
| **フィルタリング** | 勝率、トレード回数、リターン等の条件でフィルタ |

### 2.3 チャート表示機能（MVP優先度：3）

| 機能 | 詳細 |
|------|------|
| **チャート種別** | ラインチャート / ローソク足の切り替え |
| **売買マーキング** | 買い（▲緑）、売り（▼赤）をチャート上に表示 |
| **ツールチップ** | マーカーホバー時に詳細情報（日付、価格、戦略名、損益）表示 |
| **期間選択** | 表示期間のズーム・スクロール |
| **複数銘柄比較** | 最大5銘柄を同時表示（オーバーレイまたは分割表示） |

### 2.4 パラメーター調整機能（MVP優先度：4）

| 機能 | 詳細 |
|------|------|
| **調整UI** | スライダー＋数値入力の併用 |
| **デフォルト値** | 各戦略に一般的なパラメーターをプリセット |
| **リアルタイム反映** | パラメーター変更時に即座にバックテスト再実行 |
| **保存機能** | LocalStorageへ保存・読み込み |
| **リセット機能** | デフォルト値への復元 |

### 2.5 戦略サーチ・最適化機能（MVP優先度：5）

| 機能 | 詳細 |
|------|------|
| **全戦略スキャン** | 指定銘柄に対して全戦略をバックテスト |
| **ランキング表示** | 選択した指標（勝率/リターン/PF/シャープレシオ）でランク付け |
| **フィルター条件** | 勝率 ≥ X%、トレード回数 ≥ Y回 等の条件設定 |
| **グリッドサーチ** | パラメーター範囲を指定して最適値を探索 |
| **目標関数選択** | 勝率 / 総リターン / プロフィットファクター / シャープレシオ から選択 |
| **制約条件** | 最低トレード回数（推奨：30回以上） |
| **ウォークフォワード検証** | 過学習防止のためのアウトオブサンプルテスト |

### 2.6 エクスポート機能

| 機能 | 詳細 |
|------|------|
| **シグナルデータ出力** | CSV/JSON形式でシグナル（日付、銘柄、売買、価格、戦略、パラメーター）を出力 |
| **MQLコード生成** | MetaTrader 4/5用のEAテンプレートを自動生成 |
| **PineScript生成** | TradingView用のインジケーター/ストラテジーコードを自動生成 |
| **パラメーター設定** | 調整済みパラメーターのJSON形式エクスポート/インポート |

---

## 3. 対象マーケット・データ

| 項目 | 内容 |
|------|------|
| **対象市場** | 米国株、日本株、ETF、コモディティ |
| **データ種別** | 日足（OHLCV） |
| **データソース** | Yahoo Finance API（yfinance互換） |
| **データ期間** | 過去5〜10年（ユーザー選択可） |
| **更新頻度** | 手動リロード（将来的に自動更新検討） |

---

## 4. 非機能要件

| 項目 | 要件 |
|------|------|
| **レスポンシブ** | PC / タブレット / スマートフォン対応 |
| **パフォーマンス** | 40戦略のバックテスト完了まで10秒以内（5年データ） |
| **ブラウザ対応** | Chrome, Firefox, Safari, Edge（最新版） |
| **ダークモード** | 対応（shadcn/uiデフォルト機能活用） |
| **アクセシビリティ** | キーボード操作対応、適切なARIAラベル |

---

## 5. 用語定義

| 用語 | 定義 |
|------|------|
| **勝率** | 利益が出たトレード数 ÷ 総トレード数 × 100 |
| **プロフィットファクター** | 総利益 ÷ 総損失（絶対値） |
| **最大ドローダウン** | ピークからの最大下落率 |
| **シャープレシオ** | (平均リターン - リスクフリーレート) ÷ リターンの標準偏差 |
| **ウォークフォワード検証** | データを学習期間と検証期間に分割し、過学習を防ぐ検証手法 |

---

## 6. 更新履歴

| 日付 | バージョン | 内容 |
|------|-----------|------|
| 2024-12-23 | 1.0 | 初版作成 |
